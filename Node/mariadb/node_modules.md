
# Node + Maria DB
## 1. 프로그래밍 언어에서 관계형 데이터베이스를 사용하는 방법
- 데이터베이스 제조업체에서 제공하는 드라이버를 사용하거나 SQL Mapper Framework를 사용하는 방식 - SQL을 이용 - 사용하기 쉬워서 SI 같은 많은 인력이 진행하는 프로젝트에서 사용  

- ORM Framework 이용: SQL을 이용하지 않고 객체 지향 언어의 메서드를 이용해서 SQL을 자동 변환해서 수행하는 방식 - 성능이 우수하기 때문에 적은 인력을 가지고 만드는 솔루션 분야에서 많이 사용


## 2. 데이터베이스 제공업체에서 제공하는 드라이버를 이용해서 SQL을 실행

node에서 mari db는 mysql과 같은 데이터베이스로 취급


## 3. Maria DB 연동

### 1) 필요한 모듈: mysql



### 2) 필요한 정보

- 연결한 데이터베이스를 소유하고 있는 컴퓨터의 IP나 도메인과 포트번호 (localhost(127.0.0~,::1):3306

- 사용할 데이터베이스 이름(sid라고 하기도 합니다) 

- 계정: 아이디와 비밀번호


2. 연결
> App.js
``` js
// 모듈 가져오기
const mariadb=require('mysql');
// 접속 정보 가져오기
let connection = mariadb.createConnection({
	host:'아이피나 도메인',
    prot: 포트번호,
    user: '아이디',
    password: '비밀번호',
    database:'데이터베이스 이름'
});

//연결
connection.connect(function(error){
	if(error){
    	에러가 발생했을 때 수행할 내용
    }
});

//데이터베이스 연결이 되었을 때 수행할 내용
```

### 2) 연결 확인

- node 프로젝트 생성
- mysql 패키지 설치: npm install mysql
- 실행: node App.js  
에러 메세지가 출력되면 첫번째 줄을 확인해서 수정

## 3. SQL 실행
### 1) SELECT가 아닌 구문
- 결과가 성공과 실패 또는 영향받은 개수의 형태  
연결객체.query(SQL, [파라미터배열]);  
<br/>
파라미터 배열은 SQL을 작성할 때 값의 자리에 직접 값을 작성하지 않고 ?로 설정한 후 나중에 값을 대입할 수 있습니다.

> 메모장 보세요

- 데이터베이스 접속 도구에서 SELECT * FROM family; 로 데이터 조회  


### 2) SELECT 구문
- 조회한 결과(Cursor 또는 하나의 객체나 배열)  
SELECT 구문은 콜백 함수를 매개변수로 추가하는데 콜백함수의 매개변수가 3개인데 첫번째 에러 객체이고 두번째 검색된 내용인데 javascript 객체 형태로 제공되고 세번째 meta data로 검색된 결과에 대한 정보입니다.  
화면에 출력할거라면 javascript 객체를 그대로 이용하면 되고 데이터 형태로 제공하고자하면 JSON 문자열로 변환하면 됩니다.

- App.js 파일에서 접속에 성공했을 때 부분에서 데이터를 읽어오는 코드를 작성

> 메모장 보세요

## 2. 필요한 모듈 설치  
> npm install express morgan multer mysql cookie-parser express-session express-mysql-session dotenv compression file-stream-rotator

- express: 웹 서버 모듈

- morgan: 로그 기록을 위한 모듈
- file-stream-rotator: 로그를 파일에 기록하기 위한 모듈

- multer: 파일 업로드 처리를 위한 모듈

- mysql: mysql이나 maria db를 사용하기 위한 모듈

- cookie-parser: 쿠키를 사용하기 위한 모듈

- express-session: 세션을 사용하기 위한 모듈
- expressmysql-session: 세션을 mysql이나 maria db에 저장하기 위한 모듈

- dotenv: .env 파일의 내용을 process.env로 저장해서 사용하기 위한 모듈

- compression: 서버가 처리한 결과를 압축해서 클라이언트에게 전송하기 위한 모듈

### 2) 개발 모드로 설치

npm install --save-dev nodemon

- nodemon: 소스 코드를 수정하면 자동으로 재시작할 수 있도록 해주는 모듈
- package.json 파일의 Scripts 부분에 "start":"nodemon app", 을 추가: npm start 명령을 사용하면 nodemon app이라는 명령이 수행돼서 entry point로 설정한 파일을 실행시켜주는 역할

### 3) 서버의 데이터 업데이트 시간을 기록할 update.txt 파일을 프로젝트에 생성

### 4) 프로젝트에 .env 파일을 만들고 필요한 속성을 정의
``` 
PORT=9000
COOKIE_SECRET=item

HOST='192.168.0.174'
MYSQLPORT=3306
USERNAME='root'
PASSWORD='0303'
DATABASE='woo'
```

> 메모장

### 7) 프로젝트에 public 디렉토리 생성

### 8) 샘플 데이터의 이미지를 다운로드 받아서 public 디렉토리에 img
> 메모장..
